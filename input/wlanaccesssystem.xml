<?xml version="1.0" encoding="utf-8"?>
<?xsl-stylesheet type="text/xsl" href="../transforms/xsl/module/module2html.xsl"?>

<?xml-model href="../transforms/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>



<Module boilerplate="yes" target-products="Wireless Local Area Network (WLAN) Access System" 
  name="Wireless Local Area Network (WLAN) Access System"
  xmlns="https://niap-ccevs.org/cc/v1"
  xmlns:sec="https://niap-ccevs.org/cc/v1/section"
  xmlns:h="http://www.w3.org/1999/xhtml">
 
  <PPReference>
    <ReferenceTable>
      <PPVersion>1.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2021-03-10</PPPubDate>
      <Keywords>WLAN, Wireless LAN</Keywords>
    </ReferenceTable>
  </PPReference>
  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2020-10-28</date>
      <subject>Initial Release</subject>
    </entry>
  </RevisionHistory>
  
  
  <!-- TODO: no open items -->
  
  <sec:Introduction>
    <sec:Overview> 
      The scope of this PP-Module is to describe the security functionality of a Wireless Local Area Network (WLAN) Access System in terms of [CC] 
      and to define functional and assurance requirements for such products. This PP-Module is intended for use with the following Base-PPs:
      <h:ul>
        <h:li>Collaborative Protection Profile for Network Devices (NDcPP) Version 2.2e</h:li>
      </h:ul>
      This Base-PP is valid because a WLAN Access System is a device at the edge of a private network that establishes an encrypted IEEE 802.11 link that protects wireless data in transit from disclosure and modification. 
      This is functionality that typically will be implemented by a network device.
      <h:p/>
      A TOE that conforms to a PP-Configuration containing this PP-Module may be a ‘Distributed TOE’ as
      defined in the NDcPP. The TOE functionality may reside entirely within a single device or be spread across multiple distributed physical components.
      
</sec:Overview>
    <tech-terms>
      <term abbr="AES"   full="Advanced Encryption Standard"/>
      <term abbr="AP"    full="Access Point"> 
        A device that provides the network interface that enables
        wireless client hosts to access a wired network. </term>
      <term abbr="AS"    full="Access System"/>
      <term abbr="CBC"   full="Cipher Block Chaining"/>
      <term abbr="CCM"   full="Counter Mode with CBC-MAC"/>
      <term abbr="CCMP"  full="CCM mode Protocol"/>
      <term abbr="CTR"   full="Counter (encryption mode)"/>
      <term abbr="EAP"   full="Extensible Authentication Protocol"/>
      <term abbr="GCM"   full="Galois-Counter Mode"/>
      <term abbr="GTK"   full="Group Temporal Key"/>
      <term abbr="IPsec" full="Internet Protocol Security"/>
      <term abbr="MAC"   full="Media Access Control or Message Authentication Code"/>
      <term abbr="NDcPP" full="Network Device collaborative Protection Profile"/>
      <term abbr="PAE"   full="Port Access Entity"/>
      <term abbr="PMK"   full="Pairwise Master Key"/>
      <term abbr="SSID"  full="Service Set Identifier"> 
        The primary name associated with an 802.11
        wireless local area network (WLAN). </term>
      <term abbr="TLS"   full="Transport Layer Security"/>
      <term abbr="WLAN"  full="Wireless Local Area Network"> 
        A wireless computer network that links
        two or more devices using wireless communication to form a local area network (LAN) within a
        limited area such as a home, school, computer laboratory, campus, office building etc. </term>
      <term abbr="WPA"   full="Wi-Fi Protected Access"/>
    </tech-terms>
    <section title="Compliant Targets of Evaluation" id="TOEdescription">
      <sec:TOE_Boundary> 
        This PP-Module specifically addresses WLAN (IEEE 802.11) Access Systems. A compliant WLAN Access System is a
        system composed of hardware and software that is connected to a network and has an infrastructure
        role in the overall enterprise network. In particular, a WLAN Access System establishes a secure wireless
        (IEEE 802.11) link that provides an authenticated and encrypted path to an enterprise network and
        thereby decreases the risk of exposure of information transiting “over-the-air”.<h:p/>
        
        Since this PP-Module extends the NDcPP, conformant TOEs are obligated to implement the functionality
        required in the NDcPP along with the additional functionality defined in this PP-Module in response to the threat
        environment discussed subsequently herein.
      </sec:TOE_Boundary>
    </section>
    
    <sec:Use_Cases>
      <usecases>
        <usecase id="usecase1" title="Standalone Device">
          <description>The TOE is a standalone network device that serves as a single network endpoint that provides connectivity to wireless clients.</description>
        </usecase>
        <usecase id="usecase2" title="Distributed System">
          <description>The TOE is a distributed system consisting of multiple network devices that collectively serve as the wireless network endpoint. In addition to claiming the relevant "Distributed TOE" requirement in the NDcPP,
          this use case also requires the TOE to claim the optional SFR FCS_CKM.2/DISTRIB to describe the key distribution method between distributed TOE components.</description>
        </usecase>
      </usecases> 
    </sec:Use_Cases> 
  </sec:Introduction>
  <sec:Conformance_Claims>
    <cclaims>
      <cclaim name="Conformance Statement">
        <description> This PP-Module inherits exact conformance as required from the specified
          Base-PP and as defined in the CC and CEM addenda for Exact Conformance, Selection-Based
          SFRs, and Optional SFRs (dated May 2017).<h:p/> 
          
          The following PP-Modules are allowed to be specified in a PP-Configuration with this PP-Module:
          <h:ul>
            <h:li>PP-Module for Stateful Traffic Filter Firewalls, Version 1.4 + Errata 20200625</h:li>
            <h:li>PP-Module for Virtual Private Network (VPN) Gateways, Version 1.1</h:li>
          </h:ul> 
        </description>
      </cclaim>
      <cclaim name="CC Conformance Claims">
        <description>This PP-Module is conformant to Parts 2 (extended) and 3 (conformant) of Common
          Criteria Version 3.1, Release 5 [CC]. </description>
      </cclaim>
      <cclaim name="Package Claims">
        <description>This PP-Module does not
          claim conformance to any packages.</description>
      </cclaim>
    </cclaims>
  </sec:Conformance_Claims>
  <sec:Security_Problem_Description>  
    This PP-Module is written to address the situation when network packets cross the boundary
    between a wired private network and a wireless client via a WLAN Access System. The WLAN Access
    System provides secure communication between a user (wireless client) and a wired (trusted) network
    by supporting security functions such as administration, authentication, encryption, and the protection
    and handling of data in transit. To protect the data in-transit from disclosure and modification, a WLAN
    Access System is used to establish secure communications. The WLAN Access System provides one end
    of the secure cryptographic tunnel and performs encryption and decryption of network packets in
    accordance with a WLAN Access System security policy negotiated with its authenticated wireless client.
    It supports multiple simultaneous wireless connections and is capable of establishing and terminating
    multiple cryptographic tunnels to and from those peers.<h:p/>
    
    The proper installation, configuration, and administration of the WLAN Access System are critical to its
    correct operation.<h:p/>
    
    Note that this
    PP-Module does not repeat the threats identified in the NDcPP, though they all apply given the
    conformance and hence dependence of this PP-Module on the NDcPP. Note also that while the NDcPP
    contains only threats to the ability of the TOE to provide its security functions, this
    PP-Module addresses only threats to resources in the operational environment. Together the
    threats of the NDcPP and those defined in this PP-Module define the comprehensive set of
    security threats addressed by a WLAN Access System TOE. 
    <section title="Threats" id="threats">
      
      <threats>
        <threat name="T.NETWORK_DISCLOSURE">
          <description>Devices on a protected network may be exposed to threats presented by devices located outside the
            protected network, which may attempt to conduct unauthorized activities. If malicious external devices
            are able to communicate with devices on the protected network, or if devices on the protected network
            can establish communications with those external devices (e.g., as a result of nonexistent/insufficient
            WLAN data encryption that exposes the WLAN data in transit to rogue elements), then those internal
            devices may be susceptible to the unauthorized disclosure of information.</description>
          <consistency-rationale>This threat extends the security problem defined by the Base-PP to include the threat of a malicious entity in an untrusted network interacting with a protected entity in a trusted network. 
            This is not addressed in the Base-PP because not all network devices are responsible for facilitating communications between separate networks. This threat is also consistent with the T.UNTRUSTED_COMMUNICATION_CHANNELS
            threat defined by the Base-PP because compromise of data in transit is one potential way this threat may be exploited.</consistency-rationale>
          <objective-refer ref="O.AUTHENTICATION">
            <rationale>The threat T.NETWORK_DISCLOSURE is countered by O.AUTHENTICATION as proper authentication of external entities 
              ensures that network data is not disclosed to an unauthorized subject.<h:p/></rationale>
          </objective-refer>
          <objective-refer ref="O.CRYPTOGRAPHIC_FUNCTIONS">
            <rationale>The threat T.NETWORK_DISCLOSURE is countered by O.CRYPTOGRAPHIC_FUNCTIONS as implementation of cryptographic functions ensures 
              that network data is not subject to unauthorized disclosure in transit.</rationale>
          </objective-refer>
        </threat>

        <threat name="T.NETWORK_ACCESS">
          <description>Devices located outside the protected network may seek to exercise services located on the protected
            network that are intended to only be accessed from inside the protected network or only accessed by
            entities using an authenticated path into the protected network.</description>
          <consistency-rationale>This threat extends the security problem defined by the Base-PP to include the threat of a malicious entity in an untrusted network interacting with a protected entity in a trusted network. 
            This is not addressed in the Base-PP because not all network devices are responsible for facilitating communications between separate networks.</consistency-rationale>
          <objective-refer ref="O.AUTHENTICATION">
            <rationale>The threat T.NETWORK_ACCESS is countered by O.AUTHENTICATION as proper authentication methods ensure that subjects outside the protected network 
              cannot access data inside the protected network until the TSF has authenticated them.<h:p/></rationale>
          </objective-refer>
          <objective-refer ref="O.TOE_ADMINISTRATION">
            <rationale>The threat T.NETWORK_DISCLOSURE is countered by O.TOE_ADMINISTRATION as the TOE's administration function 
              does not permit execution of management functions that originate from wireless clients outside the protected network.</rationale>
          </objective-refer>
        </threat>

        <threat name="T.TSF_FAILURE">
          <description>Security mechanisms of the TOE generally build up from a primitive set of mechanisms (e.g., memory
            management, privileged modes of process execution) to more complex sets of mechanisms. Failure of
            the primitive mechanisms could lead to a compromise in more complex mechanisms, resulting in a
            compromise of the TSF. 
          </description>
          <consistency-rationale>This threat is an extension of the T.SECURITY_FUNCTIONALITY_FAILURE threat defined by the Base-PP.</consistency-rationale>
          <objective-refer ref="O.FAIL_SECURE">
            <rationale>The threat T.TSF_FAILURE is countered by O.FAIL_SECURE as the TOE responds to self-test failures that are significant enough 
              to show a potential compromise of the TSF by making the TSF unavailable until the failure state has been cleared.<h:p/></rationale>
          </objective-refer>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The threat T.TSF_FAILURE is countered by O.SYSTEM_MONITORING as the TOE generates audit records of unauthorized usage, communications outages, incorrect configuration, and other behaviors that may indicate a degraded ability to enforce its intended security
            functionality so that issues can be diagnosed and resolved appropriately.</rationale>
          </objective-refer>
        </threat>
        
        <threat name="T.DATA_INTEGRITY">
          <description>Devices on a protected network may be exposed to threats presented by devices located outside the
            protected network, which may attempt to modify the data without authorization. If known malicious
            external devices are able to communicate with devices on the protected network or if devices on the
            protected network can establish communications with those external devices then the data contained
            within the communications may be susceptible to a loss of integrity.</description>
          <consistency-rationale>This threat is a specific type of failure that may result from successful exploitation of the T.WEAK_CRYPTOGRAPHY threat defined by the Base-PP. 
            It is an extension of the Base-PP threat for communications that are specific to this PP-Module.</consistency-rationale>
          <objective-refer ref="O.CRYPTOGRAPHIC_FUNCTIONS">
            <rationale>The threat T.DATA_INTEGRITY is countered by O.CRYPTOGRAPHIC_FUNCTIONS as the TOE uses cryptographic functionality to enforce the integrity of protected data in transit.</rationale>
          </objective-refer>
        </threat>
        
        <threat name="T.REPLAY_ATTACK">
          <description>If an unauthorized individual successfully gains access to the system, the adversary may have the
            opportunity to conduct a “replay” attack. This method of attack allows the individual to capture packets
            traversing throughout the wireless network and send the packets at a later time, possibly unknown by
            the intended receiver.</description>
          <consistency-rationale>This threat is a specific type of failure that may result from successful exploitation of the T.UNAUTHORIZED_ADMINISTRATOR_ACCESS and T.UNTRUSTED_COMMUNICATIONS_CHANNELS threats defined by the Base-PP. 
            It is an extension of the Base-PP threat for communications that are specific to this PP-Module.</consistency-rationale>
          <objective-refer ref="O.AUTHENTICATION">
            <rationale>The threat T.REPLAY_ATTACK is countered by O.AUTHENTICATION as the TOE's use of authentication mechanisms prevent replay attacks because the source of the attack will not have the proper authentication data for the TSF to process the replayed traffic.<h:p/></rationale>
          </objective-refer>
          <objective-refer ref="O.CRYPTOGRAPHIC_FUNCTIONS">
            <rationale>The threat T.REPLAY_ATTACK is countered by O.CRYPTOGRAPHIC_FUNCTIONS as the TOE's use of cryptographic functionality prevents impersonation attempts that use replayed traffic.</rationale>
          </objective-refer>
        </threat>

      </threats>
    </section>
    <section title="Assumptions" id="assumption">
      <h:p/>
      All assumptions for the operational environment of the Base-PP also apply to this PP-Module.
      A.NO_THRU_TRAFFIC_PROTECTION is still operative, but only for the interfaces in the TOE that are
      defined by the Base-PP and not the PP-Module.      
      <assumptions>
        <assumption name="A.CONNECTIONS">
          <description> It is assumed that the TOE is connected to distinct networks in a manner
            that ensures that the TOE's security policies will be enforced on all applicable network
            traffic flowing among the attached networks. </description>
          <consistency-rationale>The Base-PP does not define where in a particular network architecture a network device must be deployed since it is designed to be generic to various types of network devices. This PP-Module
            defines the expected architectural deployment specifically for WLAN AS network devices.</consistency-rationale>
          <objective-refer ref="OE.CONNECTIONS">
            <rationale> The operational environment objective OE.CONNECTIONS is realized through
              A.CONNECTIONS.</rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </section>
    <sec:Organizational_Security_Policies>
      <!-- This PP-Module defines no additional organizational security policies beyond those specified in the NDcPP. -->
      <OSPs/>
    </sec:Organizational_Security_Policies>
  </sec:Security_Problem_Description>
  <sec:Security_Objectives>
    <sec:Security_Objectives_for_the_TOE>

      <SOs>
        <SO name="O.CRYPTOGRAPHIC_FUNCTIONS">
          <description>The TOE will provide means to encrypt and decrypt data to maintain confidentiality and allow for detection of modification of TSF data that is transmitted outside the TOE.
          </description>
          <consistency-rationale>
            The Base-PP does not define TOE objectives but it does define requirements for cryptographic functions.
			This objective is consistent with the functional behavior required by the Base-PP.
		  </consistency-rationale>
			
  <addressed-by>FCS_COP.1/DataEncryption (modified from Base-PP)</addressed-by>
  <rationale>
    FCS_COP.1/DataEncryption supports the objective by requiring the TSF to implement AES in the modes needed to support its other functions.
  </rationale>
			<addressed-by> FCS_IPSEC_EXT.1 (from Base-PP)</addressed-by>
  <rationale>
    FCS_IPSEC_EXT.1 supports the objective by requiring the TSF to use IPsec to implement a trusted communications channel if selected in FTP_ITC.1. 
  </rationale>
			<addressed-by> FCS_TLSC_EXT.1 (from Base-PP)</addressed-by>
  <rationale>
    FCS_TLSC_EXT.1 supports the objective by requiring the TSF to use RADIUS over TLS (RadSec) to implement a trusted communications channel if selected in FTP_ITC.1.
  </rationale>
  <addressed-by> FCS_TLSC_EXT.2 (from Base-PP)</addressed-by>
  <rationale>
    FCS_TLSC_EXT.2 supports the objective by requiring the TSF to use X.509 certificates as the authentication method used for RadSec.
  </rationale>
  <addressed-by> FCS_CKM.1/WPA</addressed-by>
  <rationale>
    FCS_CKM.1/WPA supports the objective by requiring the TSF to generate symmetric keys used for WPA2. 
  </rationale>
  <addressed-by> FCS_CKM.2/GTK</addressed-by>
  <rationale>
    FCS_CKM.2/GTK supports the objective by requiring the TSF to distribute group temporal keys used for IEEE 802.11.
  </rationale>
  <addressed-by> FCS_CKM.2/PMK</addressed-by>
  <rationale>
    FCS_CKM.2/PMK supports the objective by requiring the TSF to distribute pairwise master keys used for IEEE 802.11.
  </rationale>
  <addressed-by>FCS_CKM.2/DISTRIB (optional)</addressed-by>
  <rationale>
    FCS_CKM.2/DISTRIB supports the objective by optionally requiring the TSF to distribute IEEE 802.11 keys to any distributed TOE components using a secured method. 
  </rationale>

		  </SO>
            
              <SO name="O.AUTHENTICATION">
                <description>The TOE will provide a means to authenticate the user to ensure they are communicating with an authorized external IT entity.
                </description>
                <consistency-rationale>The Base-PP does not define TOE objectives but it does define requirements for authentication of both users and remote entities. 
                  This objective is consistent with the functional behavior required by the Base-PP.
				</consistency-rationale>
  <addressed-by>FCS_IPSEC_EXT.1 (from Base-PP)</addressed-by>
  <rationale>
    FCS_IPSEC_EXT.1 supports the objective by optionally requiring the TSF to use IPsec to implement a trusted communications channel if selected in FTP_ITC.1. 
    IPsec includes authenticating using X.509 certificates or pre-shared keys.
  </rationale>
  <addressed-by>FCS_TLSC_EXT.1 (from Base-PP)</addressed-by>
  <rationale>
    FCS_TLSC_EXT.1 supports the objective by optionally requiring the TSF to use RADIUS over TLS (RadSec) to implement a trusted communications channel if selected in FTP_ITC.1. 
    TLS includes authenticating using X.509 certificates or pre-shared keys.
  </rationale>
  <addressed-by>FCS_TLSC_EXT.2 (from Base-PP)</addressed-by>
  <rationale>
    FCS_TLSC_EXT.2 supports the objective by optionally requiring the TSF to use X.509 certificates as the authentication method used for RadSec. 
  </rationale>
  <addressed-by>FIA_X509_EXT.1/Rev (from Base-PP)</addressed-by>
  <rationale>
    FIA_X509_EXT.1/Rev supports the objective by optionally requiring the TSF to implement X.509 certificate validation if certificates are used for authentication. 
  </rationale>
  <addressed-by>FTP_ITC.1 (modified from Base-PP)</addressed-by>
  <rationale>
    FTP_ITC.1 supports the objective by requiring the TSF to identify the trusted communications channels it implements, each of which is able to support authentication.
  </rationale>
  <addressed-by>FIA_8021X_EXT.1</addressed-by>
  <rationale>
    FIA_8021X_EXT.1 supports the objective by requiring the TSF to act as the authenticator for 802.1X authentication.
  </rationale>
  <addressed-by>FIA_UAU.6</addressed-by>
  <rationale>
    FIA_UAU.6 supports the objective by requiring the TSF to re-authenticate a security administrator under certain circumstances.
  </rationale>
  <addressed-by>FTA_TSE.1</addressed-by>
  <rationale>
    FTA_TSE.1 supports the objective by requiring the TSF to deny the establishment of a wireless client session for reasons unrelated to the correctness of an authentication credential.
  </rationale>
  <addressed-by>FCS_RADSEC_EXT.1 (selection-based)</addressed-by>
  <rationale>
    FCS_RADSEC_EXT.1 supports the objective by optionally requiring the TSF to implement RadSec in accordance with a defined specification.
  </rationale>
  <addressed-by>FCS_RADSEC_EXT.2 (selection-based)</addressed-by>
  <rationale>
    FCS_RADSEC_EXT.2 supports the objective by optionally requiring the TSF to implement RadSec using pre-shared keys if that is the method chosen for peer authentication.
  </rationale>
  <addressed-by>FIA_PSK_EXT.1 (selection-based)</addressed-by>
  <rationale>
    FIA_PSK_EXT.1 supports the objective by optionally requiring the TSF to implement pre-shared key authentication if any trusted protocols require its use. 
  </rationale>

		  
		  </SO>
              
                <SO name="O.FAIL_SECURE">
                  <description>Upon a self-test failure, the TOE will shut down to ensure that data cannot be passed without adhering to the TOE's security policies.
                  </description>
                  <consistency-rationale>The Base-PP does not define TOE objectives but it does define requirements for self-testing. 
                    This PP-Module is consistent with that by defining an objective to enter a secure state if a self-test does fail.</consistency-rationale>
                  <addressed-by>FPT_TST_EXT.1 (modified from Base-PP)</addressed-by>
                  <rationale>
                    FPT_TST_EXT.1 supports the objective by requiring the TSF to perform self-tests that may aid in the detection of a TSF failure.
                  </rationale>
				  <addressed-by>FPT_FLS.1</addressed-by>
				  <rationale>
                    FPT_FLS.1 supports the objective by requiring the TSF to preserve a secure state in the event of a self-test failure.
                  </rationale>
                </SO>
  
                  <SO name="O.SYSTEM_MONITORING">
                    <description>The TOE will provide a means to audit events specific to WLAN functionality and security.
                    </description>
                    <consistency-rationale>The Base-PP does not define TOE objectives but it does define requirements for auditing. 
                      This PP-Module is consistent with that by ensuring that auditable events are appropriately defined for 
                      the WLAN AS capability.</consistency-rationale>
                    <addressed-by>FAU_GEN.1/WLAN</addressed-by>
                    <rationale>
                      FAU_GEN.1/WLAN supports the objective by requiring the TSF to generate audit records for security-relevant WLAN behavior.
                      <h:p/>
                    </rationale>
                  </SO>
                  
                    <SO name="O.TOE_ADMINISTRATION">
                      <description>The TOE will provide the functions necessary to address failed authentication attempts by a remote administrator.
                      </description>
                      <consistency-rationale>The Base-PP does not define TOE objectives but it does define requirements for management. This PP-Module is consistent with that by applying security restrictions on how the TOE's
                        management interface can be invoked.</consistency-rationale>
                      <addressed-by>FIA_AFL.1 (from Base-PP)</addressed-by>
                      <rationale>
                        FIA_AFL.1 supports the objective by requiring the TSF to block authentication if there is evidence of an attempt to compromise an administrator account through brute force.
						</rationale>
						<addressed-by>
							FMT_SMR_EXT.1
						</addressed-by>
						<rationale>
							FMT_SMR_EXT.1 supports the objective by requiring the TSF to prevent any administrative actions that originate from the 'external' network.</rationale>
 						<addressed-by>FMT_SMF.1/AccessSystem</addressed-by>
						<rationale>FMT_SMF.1/AccessSystem supports the objective by defining management functionality that is specific to WLAN Access System devices.</rationale>
                    </SO>
  
      </SOs>
      </sec:Security_Objectives_for_the_TOE>
      
    <section title="Security Objectives for the Operational Environment" id="SecurityObjectivesTOEorEnvironment"> 
      <h:p/>
      All objectives for the operational environment of the Base-PP also apply to this PP-Module.
      OE.NO_THRU_TRAFFIC_PROTECTION is still operative, but only for the interfaces in the TOE that are
      defined by the Base-PP and not the PP-Module.
      
      <SOEs>
        <SOE name="OE.CONNECTIONS">
          <description> TOE administrators will ensure that the TOE is installed in a manner that
            will allow the TOE to effectively enforce its policies on the network traffic of
            monitored networks. </description>
          <consistency-rationale>The Base-PP does not define where in a particular network architecture a network device must be deployed since it is designed to be generic to various types of network devices. This PP-Module
            defines the expected architectural deployment specifically for WLAN AS network devices.</consistency-rationale>
        </SOE>
      </SOEs>
    </section>
    <section title="Security Objectives Rationale" id="SOR">
      <!-- NOTE: This section should remain empty and is populated from the rationale tags in the previous sections.  -->
    </section>
  </sec:Security_Objectives>
  <sec:Security_Requirements>
    <!-- Kevin: What to do if base is not in github?? -->
    <base-pp id="ND" version="2.2e" name="Network Device" product="Network Device" short="ND" plural="NDs">
      <url>https://www.niap-ccevs.org/MMO/PP/CPP_ND_V2.2E.pdf</url>
  	  <cPP/>
      <modified-sfrs>
 

        <sec:from_nd_fcs title="Cryptographic Support (FCS)">
          <f-component cc-id="fcs_cop.1" name="Cryptographic Operation (AES Data Encryption/Decryption)" iteration="DataEncryption"> 
            <consistency-rationale>This PP-Module modifies the Base-PP's definition of the SFR by adding additional AES modes consistent with the standards referenced in the Base-PP, and by mandating specific selections that are
            relevant to the technology type of the PP-Module.</consistency-rationale>
            <f-element>
              <title>
                
                The TSF shall perform encryption/decryption in accordance
                with a specified cryptographic algorithm AES used in <h:b>CBC, CCMP </h:b> and <selectables>
                  <selectable>CTR</selectable>
                  <selectable>GCM</selectable>
                  <selectable><h:b>GCMP</h:b></selectable>
                  <selectable><h:b>no other</h:b></selectable>
                </selectables> <h:b>modes</h:b> and cryptographic key sizes <h:b>256 bits and</h:b> <selectables>
                  <selectable>128 bits</selectable>
                  <selectable>192 bits</selectable>
                  <selectable><h:b>no other key sizes</h:b></selectable>
                </selectables> that meet the following: AES as specified in ISO 18033-3, 
                <h:b>CBC as specified in ISO 10116, 
                  CCMP as specified in NIST SP 800-38C and IEEE 802.11-2016,</h:b> <selectables>
                    <selectable>CTR as specified in ISO 10116</selectable>
                    <selectable>GCM as specified in ISO 19772</selectable>
                    <selectable><h:b>GCMP as specified in NIST SP 800-38D and IEEE 802.11ax-2021</h:b></selectable>
                    <selectable><h:b>no other standards</h:b></selectable>
                  </selectables>. 
              </title>
              <note role="application">
                
                This requirement is modified from its definition in the NDcPP by mandating the selection of CBC mode and 128 bit key sizes
                while also defining additional AES mode and key size selections not present in the original definition. <h:p/>
                
                This requirement mandates two modes for AES with key size of 128 bits be
                implemented. It is not expected that these modes will both be used for all encryption/decryption
                functionality. Rather, the mandates serve particular purposes: to comply with the FCS_IPSEC_EXT.1
                requirements, CBC mode is mandated, and to comply with IEEE 802.11-2016, AES-CCMP (which uses AES
                in CCM as specified in SP 800-38C) must be implemented.<h:p/>
                
                For the first selection of FCS_COP.1.1/DataEncryption, the ST author should choose the additional mode or modes in
                which AES operates. For the second selection, the ST author should choose the key sizes that are
                supported by this functionality. 128-bit CCMP is required in order to comply with FCS_CKM.1/WPA.
                Note that optionally AES-CCMP-256 or AES-GCMP-256, with cryptographic key size of 256 bits, may be
                implemented for IEEE 802.11ax connections. In the future, one of these modes may be required.<h:p/>
              
              CTR mode is not used for WLAN AS capabilities but remains selectable since it may be required by another part of the TSF.
              </note>
              <aactivity>
                <TSS>There are no additional TSS evaluation activities for this component beyond what the NDcPP requires.<h:p/></TSS>
                <Guidance>There are no additional guidance evaluation activities for this component beyond what the NDcPP requires.<h:p/></Guidance>
                <Tests>In addition to the tests required by the NDcPP, the evaluator shall perform the following testing:<h:p/>
                  
                  <h:b>AES-CCM Tests</h:b><h:p/>
                  
                  The evaluator shall test the generation-encryption and decryption-verification functionality of AES-CCM for the following input parameter and tag lengths:<h:p/>
                  
                  <h:b>128 bit and 256 bit keys</h:b><h:p/>
                  
                  <h:b>Two payload lengths</h:b>. One payload length shall be the shortest supported payload length,
                  greater than or equal to zero bytes. The other payload length shall be the longest supported
                  payload length, less than or equal to 32 bytes (256 bits).<h:p/>
                  
                  <h:b>Two or three associated data lengths</h:b>. One associated data length shall be 0, if supported. One
                  associated data length shall be the shortest supported payload length, greater than or equal to
                  zero bytes. One associated data length shall be the longest supported payload length, less than
                  or equal to 32 bytes (256 bits). If the implementation supports an associated data length of 216
                  bytes, an associated data length of 216 bytes shall be tested.<h:p/>
                  
                  <h:b>Nonce lengths</h:b>. All supported nonce lengths between 7 and 13 bytes, inclusive, shall be tested.<h:p/>
                  
                  <h:b>Tag lengths</h:b>. All supported tag lengths of 4, 6, 8, 10, 12, 14 and 16 bytes shall be tested.<h:p/>
                  
                  Due to the restrictions that IEEE 802.11 specifies for this mode (nonce length of 13 and tag length of 8),
                  it is acceptable to test a subset of the supported lengths as long as the selections fall into the ranges
                  specified above. In this case, the evaluator shall ensure that these are the only supported lengths.
                  To test the generation-encryption functionality of AES-CCM, the evaluator shall perform the following
                  four tests: <h:p/>
                  
                  <testlist>
                    <test>For EACH supported key and associated data length and ANY supported payload, nonce
                      and tag length, the evaluator shall supply one key value, one nonce value and 10 pairs of
                      associated data and payload values and obtain the resulting ciphertext.</test>
                    <test>For EACH supported key and payload length and ANY supported associated data, nonce
                      and tag length, the evaluator shall supply one key value, one nonce value and 10 pairs of
                      associated data and payload values and obtain the resulting ciphertext.</test>
                    <test>For EACH supported key and nonce length and ANY supported associated data, payload
                      and tag length, the evaluator shall supply one key value and 10 associated data, payload and
                      nonce value 3-tuples and obtain the resulting ciphertext.</test>
                    <test>For EACH supported key and tag length and ANY supported associated data, payload and
                      nonce length, the evaluator shall supply one key value, one nonce value and 10 pairs of
                      associated data and payload values and obtain the resulting ciphertext</test>
                  </testlist>
                  
                  To determine correctness in each of the above tests, the evaluator shall compare the ciphertext with the
                  result of generation-encryption of the same inputs with a known good implementation.<h:p/>
                  
                  To test the decryption-verification functionality of AES-CCM, for EACH combination of supported
                  associated data length, payload length, nonce length and tag length, the evaluator shall supply a key
                  value and 15 nonce, associated data and ciphertext 3-tuples and obtain either a FAIL result or a PASS
                  result with the decrypted payload. The evaluator shall supply 10 tuples that should FAIL and 5 that
                  should PASS per set of 15.<h:p/>
                  
                  Additionally, the evaluator shall use tests from the IEEE 802.11-02/362r6 document “Proposed Test
                  vectors for IEEE 802.11 TGi”, dated September 10, 2002, Section 2.1 AES-CCMP Encapsulation Example
                  and Section 2.2 Additional AES-CCMP Test Vectors to further verify the IEEE 802.11-2016
                  implementation of AES-CCMP.
                </Tests>
              </aactivity>
            </f-element>
          </f-component>
          
        </sec:from_nd_fcs>
        
        <sec:from_nd_fpt title="Protection of the TSF (FPT)">
          <f-component cc-id="fpt_tst_ext.1" name="TSF Testing">
            <consistency-rationale>This PP-Module modifies the Base-PP's definition of the SFR by defining a minimum baseline for what self-tests must be run. Additional self-tests
              may still be specified by the ST author.</consistency-rationale>
            <f-element>
              <title>
                The TSF shall run a suite of the following self-tests <h:b>during initial start-up (on power on) and </h:b> <selectables>
                  <selectable>periodically during normal operation</selectable>
                  <selectable>at the request of the authorized user</selectable>
                  <selectable>at the conditions <assignable>conditions under which self-tests should occur</assignable></selectable>
                  <selectable><h:b>in no other circumstances</h:b></selectable>
                </selectables> to demonstrate the correct operation of the TSF: <h:b>integrity verification of stored TSF executable code when it is loaded for execution
                through the use of the TSF-provided cryptographic service specified in FCS_COP.1/SigGen, <selectables>
                  <selectable><assignable>list of additional self-tests run by the TSF</assignable></selectable>
                  <selectable>no other self-tests</selectable>
                </selectables></h:b>.
              </title>
              <note role="application">This SFR is modified from its definition in the NDcPP by mandating that self-testing occur at power on, and that the self-testing must include, at minimum,
              an integrity test using a digital signature. FCS_COP.1/SigGen is defined in the NDcPP.</note>
              <aactivity>
                The evaluator shall perform the following activities in addition to those required by the NDcPP:<h:p/>
                <TSS>The evaluator shall examine the TSS to ensure that it describes how to verify the integrity of stored TSF
                  executable code when it is loaded for execution, which includes the generation and protection of the
                  “check value” used to ensure integrity as well as the verification step. This description shall also cover
                  the digital signature service used in performing these functions. The evaluator also checks the
                  operational guidance to ensure that any actions required by the administrator to initialize or operate
                  this functionality are present.<h:p/>
                
                The evaluator shall also ensure that the TSS or operational guidance describes the actions that take place for successful and unsuccessful execution of the integrity test.<h:p/></TSS>
                <Guidance>The evaluator shall ensure that the TSS or operational guidance describes the actions that take place for successful and unsuccessful execution of the integrity test.<h:p/></Guidance>
                <Tests>The evaluator shall perform the following tests:
                <testlist>
                  <test>Following the operational guidance, the evaluator shall initialize the integrity protection system.
                    The evaluator shall perform actions to cause TSF software to load and observe that the integrity
                    mechanism does not flag any executables as containing integrity errors.
                  </test>
                  <test>The evaluator shall modify the TSF executable, and cause that executable to be loaded by the
                    TSF. The evaluator shall observe that an integrity violation is triggered (care must be taken so that the
                    integrity violation is determined to be the cause of the failure to load the module, and not the fact that
                    the module was modified so that it was rendered unable to run because its format was corrupt).
                  </test>
                </testlist></Tests>
              </aactivity>
            </f-element>
          </f-component>
        </sec:from_nd_fpt>
        
        <sec:from_nd_ftp title="Trusted Path/Channels (FTP)">
          <f-component cc-id="ftp_itc.1" name="Inter-TSF Trusted Channel">
            <consistency-rationale>This PP-Module modifies the Base-PP's definition of the SFR by specifying a minimum baseline of required communications protocols and also includes additional protocols not originally
              defined by the Base-PP. The original protocols specified in the Base-PP may still be selected by the ST author.</consistency-rationale>
            <f-element>
              <title>The TSF shall be capable of using <h:b>IEEE 802.1X, <selectables>
                <selectable id="s-ipsec">IPsec</selectable>
                <selectable id="s-radius">RADIUS over TLS</selectable>
              </selectables>, and</h:b> <selectables>
                  <selectable>SSH</selectable>
                  <selectable>TLS</selectable>
                  <selectable>DTLS</selectable>
                  <selectable>HTTPS</selectable>
                  <selectable><h:b>no other protocols</h:b></selectable>
                </selectables> to provide a trusted communication channel
                between itself and authorized IT entities supporting the following capabilities: <h:b>802.1x authentication server,</h:b> audit
                server, <selectables>
                  <selectable>authentication server</selectable>
                  <selectable><assignable>other capabilities</assignable></selectable>
                  <selectable>no other capabilities</selectable>
                </selectables> that is logically distinct
                from other communication channels and provides assured identification of its end points and protection
                of the channel data from disclosure and detection of modification of the channel data.
              </title>
              <note role="application">
                <h:p>
                  This requirement has been modified from its definition in the NDcPP to 
                  mandate the communications protocols and environmental components that 
                  a WLAN Access System must use for infrastructure communications
                  (802.11 support is also required for wireless client communications but this is covered
                  by the FTP_ITC.1/Client.
                  IPsec or RADIUS over TLS (commonly known as "RadSec") is required at least for communications with the 802.1X authentication server.
                  Other selections may be made if needed by other parts of the TSF.
                  The requirement implies that not only are communications protected when they are initially established,
                  but also on resumption after an outage.</h:p>
                <h:p>
                   The IT entity of "802.1X authentication server" is distinct from "authentication server",
                   because the latter may be used for administrator authentication rather 
                   than authorization of WLAN clients.
                </h:p><h:p>
                   If <xref to="s-ipsec"/> is selected in FTP_ITC.1.1, then FCS_IPSEC_EXT.1 from the NDcPP must be claimed.
                   If <xref to="s-radius"/> is selected in FTP_ITC.1.1,
                   then FCS_RADSEC_EXT.1 in this PP-Module must be claimed, as well as FCS_TLSC_EXT.1 from the NDcPP.
                </h:p>
              </note>
            </f-element>
            <f-element>
              <title>The TSF shall permit the TSF or the authorized IT entities to initiate communication via the trusted channel.</title>
            </f-element>
            <f-element>
              <title>The TSF shall initiate communication via the trusted channel for <assignable>list of services for which the TSF is able to initiate communications</assignable>.</title>
              <aactivity>
                The evaluator shall perform the following activities in addition to those required by the NDcPP:<h:p/>
                <TSS>The evaluator shall examine the TSS to determine that, for all communications with authorized IT
                  entities identified in the requirement, each communications mechanism is identified in terms of the
                  allowed protocols for that IT entity. The evaluator shall also confirm that all protocols listed in the TSS
                  are specified and included in the requirements in the ST.<h:p/> </TSS>
                <Guidance>The evaluator shall confirm that the guidance documentation contains instructions for establishing the
                  allowed protocols with each authorized IT entity, and that it contains recovery instructions should a
                  connection be unintentionally broken.<h:p/> 
                </Guidance>
                <Tests>The evaluator shall perform the following tests:
                  <testlist>
                    <test>The evaluator shall ensure that communications using each protocol with each authorized IT
                      entity is tested during the course of the evaluation, setting up the connections as described in the
                      guidance documentation and ensuring that communication is successful. </test>
                    <test>For each protocol that the TOE can initiate as defined in the requirement, the evaluator shall
                      follow the guidance documentation to ensure that in fact the communication channel can be initiated
                      from the TOE. </test>
                    <test>The evaluator shall ensure, for each communication channel with an authorized IT entity, the
                      channel data is not sent in plaintext.</test>
                    <test>The evaluator shall, for each protocol associated with each authorized IT entity tested during
                      test 1, physically interrupt an established connection. The evaluator shall ensure that when physical
                      connectivity is restored, communications are appropriately protected.</test>
                    <test>The evaluator shall first configure the access system to use only WPA2 (AES, with no fallback to
                      TKIP), then ensure that a WPA2 (AES) connection can be made between the access system and a client
                      device. Finally, the evaluator shall attempt to connect a client device that does not support AES to the
                      access system and ensure that the access system rejects the connection (does not fall back to TKIP).
                    </test>
                  </testlist>
                </Tests>
              </aactivity>
            </f-element>
          </f-component>
        </sec:from_nd_ftp>
 
      </modified-sfrs>
      <additional-sfrs/>
      <con-toe> 
        When this PP-Module extends the Network Device cPP, the TOE type for the overall TOE is still a network device. This PP-Module just defines the TOE as a specific type of network device with functional capabilities
        distinct to that type. </con-toe>
      <con-sec-prob/>
      <con-obj/>
      <con-op-en/>

     
      
      <!-- <con-mod id="fcs_ckm.2/DISTRIB">.</con-mod> -->

    </base-pp>
    <man-sfrs>
      
      <sec:man_fau title="Security Audit (FAU)">
        <f-component cc-id="fau_gen.1" name="Audit Data Generation" iteration="WLAN">
          <consistency-rationale>This SFR iterates the FAU_GEN.1 SFR defined in the Base-PP to define auditable events for the functionality that is specific to this PP-Module.</consistency-rationale>
<f-element>
            <title> The TSF shall be able to generate an audit record of the following auditable
              events: <h:ol type="a">
                <h:li>Start-up and shutdown of the audit functions;</h:li>
                <h:li>All auditable events for the [not specified] level of audit;</h:li>
                <h:li>[<h:i>Auditable events listed in the Auditable Events table (<xref to="auditWLAN"/>);</h:i></h:li>
                <h:li><h:i>Failure of wireless sensor communication</h:i>].</h:li>
              </h:ol>
            <h:table>
              <h:tr>
                <h:th>Requirement</h:th>
                <h:th>Auditable Events</h:th>
                <h:th>Additional Audit Record Contents</h:th>
              </h:tr>
              <h:tr>
                <h:td>FCS_CKM.1/WPA</h:td>
                <h:td colspan="2">None.</h:td>
              </h:tr>
              <h:tr>
                <h:td>FCS_CKM.2/DISTRIB (optional)</h:td>
                <h:td colspan="2">None.</h:td>
              </h:tr>
              <h:tr>
                <h:td>FCS_CKM.2/GTK</h:td>
                <h:td colspan="2">None.</h:td>
              </h:tr>
              <h:tr>
                <h:td>FCS_CKM.2/PMK</h:td>
                <h:td colspan="2">None.</h:td>
              </h:tr>
              <h:tr>
                <h:td>FCS_RADSEC_EXT.1 (selection-based)</h:td>
                <h:td colspan="2">None.</h:td>
              </h:tr>
              <h:tr>
                <h:td>FCS_RADSEC_EXT.2 (selection-based)</h:td>
                <h:td colspan="2">None.</h:td>
              </h:tr>
              <h:tr>
                <h:td rowspan="3">FCS_IPSEC_EXT.1 (selection-based)</h:td>
                <h:td>Protocol failures.</h:td>
                <h:td>Reason for failure. Non-TOE endpoint of connection.</h:td>
              </h:tr>
              <h:tr>
                <h:td>Establishment/Termination of an IPsec SA.</h:td>
                <h:td>Non-TOE endpoint of connection.</h:td>
              </h:tr>
              <h:tr>
                <h:td>Negotiation "down" from an IKEv2 to IKEv1 exchange.</h:td>
                <h:td>Non-TOE endpoint of connection.</h:td>
              </h:tr>
              <h:tr>
                <h:td rowspan="2">FIA_8021X_EXT.1</h:td>
                <h:td>Attempts to access the 802.1X controlled port prior to successful completion of the authentication exchange.</h:td>
                <h:td>Provided client identity (e.g. MAC address).</h:td>
              </h:tr>
			  <h:tr>
				<h:td>Failed authentication attempt</h:td>
				<h:td>Provided client identity (e.g. MAC address).</h:td>
			  </h:tr>
              <h:tr>
                <h:td>FIA_PSK_EXT.1 (selection-based)</h:td>
                <h:td colspan="2">None.</h:td>
              </h:tr>
              <h:tr>
                <h:td>FIA_UAU.6</h:td>
                <h:td>Attempts to re-authenticate.</h:td>
                <h:td>Origin of the attempt (e.g., IP address).</h:td>
              </h:tr>
              <h:tr>
                <h:td>FPT_FLS.1</h:td>
                <h:td>Failure of the TSF.</h:td>
                <h:td>Indication that the TSF has failed with the type of failure that occurred.</h:td>
              </h:tr>
              <h:tr>
                <h:td rowspan="2">FPT_TST_EXT.1</h:td>
                <h:td>Execution of TSF self-test.</h:td>
                <h:td>None.</h:td>
              </h:tr>
              <h:tr>
                <h:td>Detected integrity violations.</h:td>
                <h:td>The TSF code file that caused the integrity violation.</h:td>
              </h:tr>
              <h:tr>
                <h:td>FTA_TSE.1</h:td>
                <h:td>Failure of the TSF.</h:td>
                <h:td>Indication that the TSF has failed with the type of failure that occurred.</h:td>
              </h:tr>
              <h:tr>
                <h:td rowspan="2">FTP_ITC.1</h:td>
                <h:td>Failed attempts to establish a trusted channel (including IEEE 802.11).</h:td>
                <h:td rowspan="2">Identification of the initiator and target of channel.</h:td>
              </h:tr>
              <h:tr>
                <h:td>Detection of modification of channel data.</h:td>
              </h:tr>
            </h:table>
              <ctr ctr-type="Table" id="auditWLAN">: Auditable Events</ctr>
            </title>
  <note role="application"> The auditable events defined in <xref to="auditWLAN"/>
    are for the SFRs that are explicitly defined in this PP-Module and are intended to
    extend FAU_GEN.1 in the Base-PP. The events in the Auditable Events table should
    be combined with those of the NDcPP in the context of a conforming Security
    Target.<h:p/> The Auditable Events (<xref to="auditWLAN"/>) includes
    optional and objective SFRs. The auditing of optional and objective SFRs is only
    required if that SFR is included in the ST. <h:p/> Per FAU_STG_EXT.1 in the
    Base-PP, the TOE must support transfer of the audit data to an external IT entity
    using a trusted channel. </note>
  <aactivity>
    <TSS> There are no TSS evaluation activities for this SFR.<h:p/>
    </TSS>
    <Guidance> There are no operational guidance activities for this SFR.<h:p/>
    </Guidance>
    <Tests> The evaluator shall test the TOE’s ability to correctly generate audit records
      by having the TOE generate audit records in accordance with the evaluation activities
      associated with the functional requirements in this PP-Module. When verifying the
      test results, the evaluator shall ensure the audit records generated during testing
      match the format specified in the administrative guide, and that the fields in each
      audit record have the proper entries. <h:p/> Note that the testing here can
      be accomplished in conjunction with the testing of the security mechanisms directly.
    </Tests>
  </aactivity>
</f-element> 
        </f-component>
      </sec:man_fau>
      
      <sec:man_fcs title="Cryptographic Support (FCS)">
        
        <!-- previously FCS_CKM.1(2) -->
        <f-component name="Cryptographic Key Generation (Symmetric Keys for WPA2 Connections)" cc-id="fcs_ckm.1" iteration="WPA">
            <consistency-rationale>This SFR defines additional cryptographic functionality not defined in the Base-PP but it implements this using the DRBG mechanism already defined in the Base-PP.</consistency-rationale>
          <f-element>
            <title>
              The TSF shall generate <h:b>symmetric</h:b> cryptographic keys in accordance with a
              specified cryptographic key generation algorithm [<h:i>PRF-384 and <selectables>
                <selectable>PRF-704</selectable>
                <selectable>no other algorithm</selectable>
              </selectables></h:i>] and specified key sizes [<h:i>128 bits and <selectables>
                <selectable>256 bits</selectable>
                <selectable>no other key sizes</selectable>
              </selectables></h:i>] <h:b>using a Random Bit Generator as specified in FCS_RBG_EXT.1</h:b> that meet the following: 
              [<h:i>IEEE 802.11-2016 and <selectables>
                <selectable>IEEE 802.11ax-2021</selectable>
                <selectable>no other standards</selectable>
              </selectables></h:i>].
            </title>
            <note role="application">
              The cryptographic key derivation algorithm required by IEEE 802.11-2016 (Section
              11.6.1.2) and verified in WPA2 certification is PRF-384, which uses the HMAC-SHA-1 function and
              outputs 384 bits. The use of GCMP is defined in IEEE 802.11ax-2021 (Section 11.4.5) and requires a KDF
              based on HMAC-SHA-256 (for 128-bit symmetric keys) or HMAC-SHA-384 (for 256-bit symmetric keys).
              This KDF outputs 704 bits.<h:p/><h:p/>
              
              This requirement applies only to the keys that are generated/derived for the communications between
              the access point and the client once the client has been authenticated. It refers to the derivation of the
              GTK (through the RBG specified in this PP-Module) as well as the derivation of the PTK from the PMK, which is
              done using a random value generated by the RBG specified in this PP-Module, the HMAC function as specified in
              this PP-Module, as well as other information. This is specified in IEEE 802.11-2016 primarily in chapter 11.
              FCS_RBG_EXT.1 is defined in the NDcPP.
            </note>
            <aactivity>
              <TSS>The cryptographic primitives will be verified through evaluation activities specified elsewhere in this PP-Module.
                The evaluator shall verify that the TSS describes how the primitives defined and implemented by this PP-Module
                are used by the TOE in establishing and maintaining secure connectivity to the wireless clients. This
                description shall include how the GTK and PTK are generated or derived. The TSS shall also provide a
                description of the developer’s method(s) of assuring that their implementation conforms to the
                cryptographic standards; this includes not only testing done by the developing organization, but also
                proof of third-party testing that is performed (e.g. WPA2 certification). The evaluator shall ensure that
                the description of the testing methodology is of sufficient detail to determine the extent to which the
                details of the protocol specifics are tested.<h:p/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:p/></Guidance>
              <Tests>The evaluator shall perform the following test using a packet sniffing tool to collect frames between
                the TOE and a wireless client:<h:p/>
                
                Step 1: The evaluator shall configure the access point to an unused channel and configure the WLAN
                sniffer to sniff only on that channel (i.e., lock the sniffer on the selected channel). The sniffer should also
                be configured to filter on the MAC address of the TOE and/or client.<h:p/>
                
                Step 2: The evaluator shall configure the TOE to communicate with a WLAN client using IEEE 
                802.11-2016 and a 256-bit (64 hex values 0-f) pre-shared key, setting up the connections as described in the
                operational guidance. The pre-shared key is only used for testing.<h:p/>
                
                Step 3: The evaluator shall start the sniffing tool, initiate a connection between the TOE and WLAN
                client, and allow the TOE to authenticate, associate and successfully complete the 4-way handshake
                with the client.<h:p/>
                
                Step 4: The evaluator shall set a timer for 1 minute, at the end of which the evaluator shall disconnect
                the client from the TOE and stop the sniffer.<h:p/>
                
                Step 5: The evaluator shall identify the 4-way handshake frames (denoted EAPOL-key in Wireshark
                captures) and derive the PTK from the 4-way handshake frames and pre-shared key as specified in IEEE
                802.11-2016.<h:p/>
                
                Step 6: The evaluator shall select the first data frame from the captured packets that was sent between
                the client and TOE after the 4-way handshake successfully completed, and without the frame control
                value 0x4208 (the first 2 bytes are 08 42). The evaluator shall use the PTK to decrypt the data portion of
                the packet as specified in IEEE 802.11-2016, and shall verify that the decrypted data contains ASCII-readable text.<h:p/>
                
                Step 7: The evaluator shall repeat Step 6 for the next 2 data frames between the TOE and client, and
                without frame control value 0x4208.<h:p/>
                
                Additionally, the evaluator shall test the PRF function using the test vectors from: <h:ul>
                  <h:li>Section 2.4 “The PRF Function – PRF(key, prefix, data, length)” of the IEEE 802.11-02/362r6 document "Proposed Test vectors for IEEE 802.11 TGi" dated September 10, 2002, and</h:li>
                  <h:li>Annex J.3 “PRF reference implementation and test vectors” of IEEE 802.11-2016.</h:li>
                </h:ul>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <!-- previously FCS_CKM.2(3) -->
        <f-component name="Cryptographic Key Distribution (GTK)" cc-id="fcs_ckm.2" iteration="GTK">
          <consistency-rationale>This SFR defines additional cryptographic functionality not defined in the Base-PP that is used for functionality outside the original scope of the Base-PP.</consistency-rationale>
          <f-element>
            <title>
              The TSF shall distribute <h:b>Group Temporal Key (GTK)</h:b> in accordance with a specified cryptographic key distribution method: <selectables>
                <selectable>AES Key Wrap in an EAPOL-Key frame</selectable>
                <selectable>AES Key Wrap with Padding in an EAPOL-Key frame</selectable>
              </selectables> that meets the following: [<h:i>NIST SP 800-38F, IEEE 802.11-2016 for the packet format and timing considerations</h:i>] <h:b>
                and does not expose the cryptographic keys</h:b>. 
            </title>
            <note role="application">This requirement applies to the Group Temporal Key (GTK) that is generated by the
              TOE for use in broadcast and multicast messages to clients to which it is connected. 802.11-2016
              specifies the format for the transfer as well as the fact that it must be wrapped by the AES Key Wrap
              method specified in NIST SP 800-38F.</note>
            <aactivity>
              <TSS>The evaluator shall check the TSS to ensure that it describes how the GTK is wrapped prior to being
                distributed using the AES implementation specified in this PP-Module, and also how the GTKs are distributed
                when multiple clients connect to the TOE.<h:p/> </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:p/></Guidance>
              <Tests>The evaluator shall perform the following test using a packet sniffing tool to collect frames between
                a wireless client and the TOE (which may be performed in conjunction with the evaluation activity for
                FCS_CKM.1/PMK.<h:p/>
                
                To fully test the broadcast/multicast functionality, these steps shall be performed as the evaluator
                connects multiple clients to the TOE.The evaluator shall ensure that GTKs established are sent to the appropriate participating clients.<h:p/>
                
                Step 1: The evaluator shall configure the access point to an unused channel and configure the WLAN
                sniffer to sniff only on that channel (i.e., lock the sniffer on the selected channel). The sniffer should also
                be configured to filter on the MAC address of the TOE and/or client.<h:p/>
                
                Step 2: The evaluator shall configure the TOE to communicate with the client using IEEE 802.11-2016
                and a 256-bit (64 hex values 0-f) pre-shared key, setting up the connections as described in the
                operational guidance. The pre-shared key is only used for testing.<h:p/>
                
                Step 3: The evaluator shall start the sniffing tool, initiate a connection between the TOE and client, and
                allow the client to authenticate, associate and successfully complete the 4-way handshake with the TOE.<h:p/>
                
                Step 4: The evaluator shall set a timer for 1 minute, at the end of which the evaluator shall disconnect
                the TOE from the client and stop the sniffer.<h:p/>
                
                Step 5: The evaluator shall identify the 4-way handshake frames (denoted EAPOL-key in Wireshark
                captures) and derive the PTK and GTK from the 4-way handshake frames and pre-shared key as
                specified in IEEE 802.11-2016.<h:p/>
                
                Step 6: The evaluator shall select the first data frame from the captured packets that was sent between
                the TOE and client after the 4-way handshake successfully completed, and with the frame control value
                0x4208 (the first 2 bytes are 08 42). The evaluator shall use the GTK to decrypt the data portion of the
                selected packet as specified in IEEE 802.11-2016, and shall verify that the decrypted data contains ASCII-readable text.<h:p/>
                
                Step 7: The evaluator shall repeat Step 6 for the next 2 data frames with frame control value 0x4208.<h:p/>
                
                The evaluator shall also perform the following testing based on the supported GTK distribution method(s):<h:p/>
                
                <h:b>AES Key Wrap (AES-KW Tests)</h:b><h:p/>
                <testlist>
                  <test>The evaluator shall test the authenticated encryption functionality of AES-KW for EACH combination of the following input parameter lengths:<h:p/>
                    
                    128 and 256 bit key encryption keys (KEKs)<h:p/>
                    
                    Three plaintext lengths. One of the plaintext lengths shall be two semi-blocks (128 bits). 
                    One of the plaintext lengths shall be three semi-blocks (192 bits). 
                    The third data unit length shall be the longest supported plaintext length less than or equal to 64 semi-blocks (4096 bits).<h:p/>
                    
                    using a set of 100 key and plaintext pairs and obtain the ciphertext that results from AES-KW authenticated encryption. 
                    To determine correctness, the evaluator shall use the AES-KW authenticated-encryption function of a known good implementation.</test>
                  <test>The evaluator shall test the authenticated-decryption functionality of AES-KW using the same test as for authenticated-encryption, 
                    replacing plaintext values with ciphertext values and AES-KW authenticated-encryption with AES-KW authenticated-decryption. 
                    Additionally, the evaluator shall modify one byte of the ciphertext, attempt to decrypt the modified ciphertext, and ensure that a failure is returned rather than plaintext.</test>
                </testlist>
                
                <h:b>AES Key Wrap with Padding (AES-KWP Tests)</h:b><h:p/>
                <testlist>
                  <test>The evaluator shall test the authenticated-encryption functionality of AES-KWP for EACH combination of the following input parameter lengths:<h:p/>
                    
                    128 and 256 bit key encryption keys (KEKs)<h:p/>
                    
                    Three plaintext lengths. One plaintext length shall be one octet. 
                    One plaintext length shall be 20 octets (160 bits). 
                    One plaintext length shall be the longest supported plaintext length less than or equal to 512 octets (4096 bits).<h:p/>
                    
                    using a set of 100 key and plaintext pairs and obtain the ciphertext that results from AES-KWP authenticated encryption. 
                    To determine correctness, the evaluator shall use the AES-KWP authenticated-encryption function of a known good implementation.</test>
                  <test>The evaluator shall test the authenticated-decryption functionality of AES-KWP using the same test as for AES-KWP authenticated-encryption, 
                    replacing plaintext values with ciphertext values and AES-KWP authenticated-encryption with AES-KWP authenticated-decryption. 
                    Additionally, the evaluator shall modify one byte of the ciphertext, attempt to decrypt the modified ciphertext, and ensure that a failure is returned rather than plaintext.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        <!-- previously FCS_CKM.2(2) -->
        <f-component name="Cryptographic Key Distribution (PMK)" cc-id="fcs_ckm.2" iteration="PMK">
          <consistency-rationale>This SFR defines additional cryptographic functionality not defined in the Base-PP that is used for functionality outside the original scope of the Base-PP.</consistency-rationale>
          <f-element>
            <title>
              The TSF shall <h:b>receive the 802.11 Pairwise Master Key (PMK)</h:b> in
              accordance with a specified cryptographic key distribution method: [<h:i>from 802.1X Authorization Server</h:i>]
              that meets the following: [<h:i>IEEE 802.11-2016</h:i>] <h:b>and does not expose the cryptographic keys</h:b>.
            </title>
            <note role="application">
              This requirement applies to the Pairwise Master Key that is received from the RADIUS
              server by the TOE. The intent of this requirement is to ensure conformant TOEs implement 802.1X
              authentication prior to establishing secure communications with the client.
              The intent is that any WLAN AS evaluated against this PP-Module will support both
              WPA2-Enterprise and WPA3-Enterprise at a minimum and certificate-based authentication mechanisms
              and therefore disallows implementations that support only pre-shared keys. Because communications
              with the RADIUS server are required to be performed over a protected connection, the transfer
              of the PMK will be protected.
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to determine that it describes how the PMK is transferred (that is,
                through what EAP attribute) to the TOE.<h:p/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:p/></Guidance>
              <Tests>The evaluator shall establish a session between the TOE and a RADIUS server according to the
                configuration guidance provided. The evaluator shall then examine the traffic that passes between the
                RADIUS server and the TOE during a successful attempt to connect a wireless client to the TOE to
                determine that the PMK is not exposed.</Tests>
            </aactivity>
          </f-element>
        </f-component>
        
      </sec:man_fcs>
      
      
      <sec:man_fia title="Identification and Authentication (FIA)">
      <!-- FIA_AFL.1 no longer needed, removed -->
        
        
        <!-- FIA_8021X_EXT.1 no change -->
        <ext-comp-def title="802.1X Port Access Entity (Authenticator) Authentication" fam-id="FIA_8021X_EXT">
          <fam-behavior>Components in this family describe requirements for implementation of 802.1X port-based network access control.</fam-behavior> 
        </ext-comp-def>   
        
        <f-component name="802.1X Port Access Entity (Authenticator) Authentication" cc-id="fia_8021x_ext.1">
          
          <consistency-rationale>This SFR defines support for 802.1X communications, which is a logical interface that extends the scope of what the Base-PP originally defined.</consistency-rationale>
          
          <comp-lev>requires the TSF to securely implement IEEE 802.1X as an authenticator.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the
            PP/ST: <h:ul>
              <h:li>Attempts to access the 802.1X controlled port prior to successful completion of the authentication exchange.</h:li>
            </h:ul>
          </audit>
          <dependencies>No dependencies</dependencies>
          
          <f-element><title>The TSF shall conform to IEEE Standard 802.1X for a Port Access Entity (PAE) in the
            “Authenticator” role.</title></f-element>
          <f-element><title>The TSF shall support communications to a RADIUS authentication server
            conforming to RFCs 2865 and 3579.</title></f-element>
          <f-element><title>The TSF shall ensure that no access to its 802.1X controlled port is given to the
            wireless client prior to successful completion of this authentication exchange.</title>
          <note role="application">
            This requirement covers the TOE's role as the authenticator in an 802.1X
            authentication exchange. If the exchange is completed successfully, the TOE will obtain the PMK from
            the RADIUS server and perform the 4-way handshake with the wireless client (supplicant) to begin
            802.11 communications.<h:p/>
            
            As indicated previously, there are at least three communication paths present during the exchange; two
            with the TOE as an endpoint and one with TOE acting as a transfer point only. The TOE establishes an
            EAP over LAN (EAPOL) connection with the wireless client as specified in 802.1X-2007. The TOE also
            establishes (or has established) a RADIUS protocol connection protected either by IPsec or RadSec (TLS) with the RADIUS server. 
            The wireless client and RADIUS server establish an EAP-TLS session
            (RFC 5216); in this transaction the TOE merely takes the EAP-TLS packets from its EAPOL/RADIUS
            endpoint and transfers them to the other endpoint. Because the specific authentication method (TLS in
            this case) is opaque to the TOE, there are no requirements with respect to RFC 5126 in this PP-Module.
            However, the base RADIUS protocol (2865) has an update (3579) that will need to be addressed in the
            implementation and evaluation activities. Additionally, RFC 5080 contains implementation issues that
            will need to be addressed by developers, but which levy no new requirements.<h:p/>
            
            The point of performing 802.1X authentication is to provide access to the network (assuming the
            authentication was successful and that all 802.11 negotiations are performed successfully); in the
            terminology of 802.1X, this means the wireless client has access to the "controlled port" maintained by
            the TOE.
          </note>
            <aactivity>
              <TSS>
                In order to show that the TSF implements the 802.1X-2010 standard correctly, the evaluator shall ensure
                that the TSS contains the following information: <h:ul>
                <h:li>The sections (clauses) of the standard that the TOE implements;</h:li>
                <h:li>For each identified section, any options selected in the implementation allowed by the
                standards are specified; and</h:li>
                <h:li>For each identified section, any non-conformance is identified and described, including a
                justification for the non-conformance.</h:li>
                </h:ul>
                Because the connection to the RADIUS server will be contained in an IPsec or RadSec (TLS) tunnel,
                the security mechanisms detailed in the RFCs identified in the requirement are not relied on to provide
                protection for these communications. Consequently, no extensive analysis of the RFCs is required.
                However, the evaluator shall ensure that the TSS describes the measures (documentation, testing) that
                are taken by the product developer to ensure that the TOE conforms to the RFCs listed in this
                requirement.<h:p/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:p/></Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                
                <testlist>
                  <test>The evaluator shall demonstrate that a wireless client has no access to the test network. After
                    successfully authenticating with a RADIUS server through the TOE, the evaluator shall demonstrate that
                    the wireless client does have access to the test network.</test>
                  <test>The evaluator shall demonstrate that a wireless client has no access to the test network. The
                    evaluator shall attempt to authenticate using an invalid client certificate, such that the EAP-TLS
                    negotiation fails. This should result in the wireless client still being unable to access the test network.
                  </test>
                  <test>The evaluator shall demonstrate that a wireless client has no access to the test network. The
                    evaluator shall attempt to authenticate using an invalid RADIUS certificate, such that the EAP-TLS
                    negotiation fails. This should result in the wireless client still being unable to access the test network.</test>
                </testlist>
                
                <h:b>Note: </h:b>Tests 2 and 3 above are not tests that "EAP-TLS works", although that's a by-product of the test.
                The test is actually that a failed authentication (under two failure modes) results in denial of access to
                the network, which demonstrates the enforcement of FIA_8021X_EXT.1.3.
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      
      <!-- FIA_UAU.6 no change -->
      <f-component name="Re-Authenticating" cc-id="fia_uau.6">
        <consistency-rationale>This SFR defines support for re-authentication of wireless users, which are a type of subject beyond the scope of what the Base-PP originally defined.</consistency-rationale>
        <f-element>
          <title>The TSF shall re-authenticate the <h:b>administrative</h:b> user under the conditions [<h:i>when the user
            changes their password, <selectables>
              <selectable>following TSF-initiated session locking</selectable>
              <selectable><assignable>other conditions</assignable></selectable>
              <selectable>no other conditions</selectable>
            </selectables></h:i>]. 
          </title>
          <aactivity>
            <TSS>There are no TSS evaluation activities for this component.<h:p/></TSS>
            <Guidance>There are no guidance evaluation activities for this component.<h:p/></Guidance>
            <Tests>The evaluator shall attempt to change their password as directed by the operational guidance.
              While making this attempt, the evaluator shall verify that re-authentication is required.<h:p/>
              
              If other re-authentication conditions are specified, the evaluator shall cause those conditions to occur and verify that the TSF re-authenticates the authenticated user.
            </Tests>
          </aactivity>
        </f-element>
      </f-component>
        
        <!-- FIA_PSK_EXT.1 moved to sel-based -->
      </sec:man_fia>
      
      <sec:man_fmt title="Security Management (FMT)">
        <f-component name="Specification of Management Functions" cc-id="fmt_smf.1" iteration="AccessSystem">
			<consistency-rationale>This SFR defines additional management functionality that is specific to the Module’s product type and would therefore not be expected to be present in the Base-PP.</consistency-rationale>
			<f-element>
			<title>The TSF shall be capable of performing the following management functions: [<h:i>set allowed wireless frequency band to 
				<selectables>
				<selectable>2.4 GHz</selectable>
				<selectable>5 GHz</selectable>
				<selectable>6 GHz</selectable>
				</selectables></h:i>].</title>
			<aactivity>
				<Guidance> 
					The evaluator shall review the operational guidance to ensure it contains instructions 
					for configuring the specified frequency band that the TOE is operating on.
				</Guidance>
				<Tests>
				The evaluator shall configure the TOE to operate in each of the selected frequency bands
				and ensure it functions correctly each selected band.
				</Tests>
			</aactivity>
		</f-element>
		</f-component>
        <ext-comp-def title="Security Management Restrictions" fam-id="FMT_SMR_EXT">
          <fam-behavior>Components in this family describe architectural restrictions on security administration that are not defined in CC Part 2.</fam-behavior> 
        </ext-comp-def>
        <!-- previously FMT_SMR.1 -->
        <f-component name="No Administration from Client" cc-id="fmt_smr_ext.1">
          <consistency-rationale>This SFR applies restrictions on when the execution of management functions is authorized. It does not prevent proper administration of the TSF.</consistency-rationale>
          
          <comp-lev>requires the TSF to reject remote administration from a wireless client by default.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FMT_SMF.1 Specification of Management Functions</dependencies>
          
          <f-element>
            <title>
              The TSF shall ensure that the ability to remotely administer the TOE from a wireless client
              shall be disabled by default.
            </title>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:p/></TSS>
              
              <Guidance>The evaluator shall review the operational guidance to ensure that it contains instructions for
                administering the TOE both locally and remotely, including any configuration that needs to be
                performed on the client for remote administration. The evaluator shall confirm that the TOE
                does not permit remote administration from a wireless client by default.<h:p/></Guidance>
              
              <Tests>The evaluator shall demonstrate that after configuring the TOE for first use from the operational
                guidance, it is possible to establish an administrative session with the TOE on the “wired” portion of the
                device. They shall then demonstrate that an identically configured wireless client that can successfully
                connect to the TOE cannot be used to perform administration.</Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:man_fmt>
      
      
      <sec:man_fpt title="Protection of the TSF (FPT)">
        <!-- FPT_FLS.1 no change -->
        <f-component name="Failure with Preservation of Secure State" cc-id="fpt_fls.1">
          <consistency-rationale>This SFR extends the functionality described by FPT_TST_EXT.1 in the Base-PP by defining the specific TSF reaction in the event of a failed self-test.</consistency-rationale>
          <f-element>
            <title>The TSF shall preserve a secure state when the following types of failures occur: [<h:i>failure of
              the self-tests</h:i>].</title>
            <note role="application">
              The intent of this requirement is to express the fail secure capabilities that the TOE
              possesses. This means that the TOE must be able to attain a secure/safe state (shutdown) when any of
              the identified failures occur.
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to determine that the TOE’s implementation of the fail secure
                functionality is documented. The evaluator shall examine the TSS to ensure that it describes all failure
                conditions and how a secure state is preserved if any of these failures occur. The evaluator shall ensure that 
                the definition of a secure state is suitable to ensure the continued protection of any key material and user data.<h:p/> 
              </TSS>
              <Guidance>The evaluator shall examine the operational guidance to verify that it describes applicable recovery instructions for each TSF failure state.<h:p/></Guidance>
              <Tests>For each failure mode specified in the ST, the evaluator shall ensure that the TOE attains a secure state
                (e.g., shutdown) after initiating each failure mode type.
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:man_fpt>
      
      <sec:man_fta title="TOE Access (FTA)">
        <!-- FTA_TSE.1 no change -->
        <f-component name="TOE Session Establishment" cc-id="fta_tse.1">
          <consistency-rationale>This SFR applies restrictions on establishment of wireless communications, which is a logical interface that extends the scope of what the Base-PP originally defined.</consistency-rationale>
          <f-element>
            <title>The TSF shall be able to deny session establishment <h:b>of a wireless client session</h:b> based
              on [<h:i>TOE interface, time, day, <selectables>
                <selectable><assignable>other attributes</assignable></selectable>
                <selectable>no other attributes</selectable>
              </selectables></h:i>].
            </title>
            <note role="application">
              The “TOE interface” can be specified in terms of the device in the TOE that the WLAN
              client is connecting to (e.g. specific WLAN access point(s)). “Time” and “day” refer to time-of-day and
              day-of-week respectively.<h:p/>
              
              The assignment is to be used by the ST author to specify additional attributes on which denial of session
              establishment can be based.
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to determine that all of the attributes on which a client session can
                be denied are specifically defined.<h:p/> </TSS>
              <Guidance>The evaluator shall examine the operational guidance to determine that it contains guidance for
                configuring each of the attributes identified in the TSS.<h:p/> </Guidance>
              <Tests>
                For each supported attribute, the evaluator shall perform the following test:
                <testlist>
                  <test>The evaluator successfully establishes a client session with a wireless client. The evaluator then
                    follows the operational guidance to configure the system so that that client’s access is denied based on
                    a specific value of the attribute. The evaluator shall then attempt to establish a session in contravention
                    to the attribute setting (for instance, the client is denied WLAN access based upon the TOE interface
                    (e.g. WLAN access point) it is connecting to or the client is denied access based upon the time-of-day or
                    day-of-week it is attempting connection on). The evaluator shall observe that the access attempt fails.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:man_fta>
	  <sec:man_ftp title="Trusted Path/Channels (FTP)">
		  <f-component cc-id="ftp_itc.1" name="Inter-TSF Trusted Channel (WLAN Client Communications)" iteration="Client">
		  <consistency-rationale>
			  This SFR iterates the FTP_ITC.1 SFR defined in the Base-PP to define trusted communication channels for the functionality that is specific to this PP-Module.
			  </consistency-rationale>
			  <f-element>
			  <title>The TSF shall be capable of using WPA3-Enterprise, WPA2-Enterprise and 
				  <selectables>
					  <selectable>WPA3-SAE</selectable>
					  <selectable>WPA2-PSK</selectable>
					  <selectable exclusive="yes">no other mode</selectable>
				  </selectables>
				  as defined by IEEE 802.11-2020 to provide a trusted communication channel
				  between itself and WLAN clients that is logically distinct from 
				  other communication channels and provides assured identification of its end
				  points and protection of the channel data from disclosure and detection of
				  modification of the channel data.
				  </title>
				</f-element>
			    <f-element>
		<title>
			The TSF shall permit the authorized IT entities to initiate communication via the trusted channel.
		</title>
	</f-element>
			  <f-element>
			  <title>The TSF shall initiate communication via the trusted channel for [<h:i>no services</h:i>].</title>
				  <aactivity>

The evaluator shall perform the following activities in addition to the evaluation activity specified in the base NDcPP for this SFR:
<TSS> 
   The evaluator shall examine the TSS to determine that all communication mechanisms are identified in terms of the allowed protocols.
   The evaluator shall also confirm that all protocols listed in the TSS are specified and included in the requirements in the ST.
</TSS>
<Guidance>
  The evaluator shall confirm that the guidance documentation contains instructions for establishing the allowed protocols and 
  that it contains recovery instructions should a connection be unintentionally broken.
</Guidance>
<Tests>
The evaluator shall perform the following tests:
<testlist>
  <test>The evaluator shall first configure the access system to use only WPA2 (AES, with no fallback to TKIP), then ensure that a WPA2 (AES) connection can be made between the access system and a client device.  Finally, the evaluator shall attempt to connect a client device that does not support AES to the access system and ensure that the access system rejects the connection (does not fall back to TKIP).</test>
  <test>The evaluator shall first configure the access system to use only WPA3, then ensure that a WPA3 connection can be made between the access system device.  Finally, the evaluator shall attempt to connect a client device that does not support WPA3 to the access system and ensure that the access system rejects the connection (does not fall back to WPA2). </test></testlist>
   </Tests></aactivity>	  
			  </f-element>
		  </f-component>
      </sec:man_ftp>
        
    </man-sfrs>
    <opt-sfrs>
      <sec:opt_fcs title="Cryptographic Support (FCS)">
        
        <!-- previously FCS_CKM.2(4) -->
        <f-component name="Cryptographic Key Distribution (802.11 Keys)" cc-id="fcs_ckm.2" iteration="DISTRIB">
          <consistency-rationale>This SFR defines an additional use for the cryptographic and self-protection mechanisms defined in the Base-PP.</consistency-rationale>
          <f-element>
            <title>The TSF shall distribute <h:b>the IEEE 802.11</h:b> keys in accordance with a
              specified key distribution method: [<h:i>trusted channel protocol specified in FPT_ITT.1</h:i>] that meets the following: [<h:i>standards specified in the various iterations of FCS_COP.1</h:i>] <h:b>and
                does not expose the cryptographic keys</h:b>.
            </title>
            <note role="application">This requirement is only applicable when the TOE is distributed (i.e., FPT_ITT.1 from the NDcPP is claimed).<h:p/>
              This requirement applies to any key necessary for successful IEEE 802.11 connections
              not covered by FCS_CKM.2/GTK. In cases where a key must be distributed to other access points, this
              communication must be performed via a mechanism of commensurate cryptographic strength. Because
              communications with any component of a distributed TOE are required to be performed over a trusted
              connection, the transfer of these keys will be protected.<h:p/>
            FCS_COP.1 and FPT_ITT.1 are defined in the NDcPP.</note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to determine that it describes which keys are distributed outside
                the TOE, where they are sent, and the purpose for this transfer.<h:p/></TSS>
              <Guidance>If this function is dependent on TOE configuration, the evaluator shall confirm that the operational
                guidance contains instructions for how to configure that the keys are adequately protected.<h:p/>
              </Guidance>
              <Tests>This requirement will be tested in conjunction with the tests for the cryptographic primitives, the secure
                protocols, and FPT_ITT.1.</Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:opt_fcs>   

    <!-- FPT_ITT.1 removed because it exists in the NDcPP now  -->

    </opt-sfrs>
    <sel-sfrs>
      
      <sec:sel_fcs title="Cryptographic Support (FCS)">
        
        <ext-comp-def title="RadSec" fam-id="FCS_RADSEC_EXT">
          <fam-behavior>Components in this family describe requirements for implementation of the RadSec (RADIUS over TLS) protocol.</fam-behavior> 
        </ext-comp-def>
        <!-- added by TD0271 -->
        <f-component name="RadSec" cc-id="fcs_radsec_ext.1">
		  <depends on="s-radius"/>
          <consistency-rationale>This SFR defines the implementation of RadSec and the peer authentication method that it uses. 
            This relies on the TLS requirements defined by the Base-PP and may also use the X.509 certificate validation methods
            specified in the Base-PP, depending on the selected peer authentication method.</consistency-rationale>
          
          <comp-lev>requires the TSF to implement RadSec using a specified peer authentication method.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_TLSC_EXT.1 TLS Client Protocol<h:p/>
            <no-link>FIA_PSK_EXT.1</no-link> Pre-Shared Key Composition<h:p/>
          FIA_X509_EXT.1 X.509 Certificate Validation</dependencies>
          
          <f-element>
            <title>
              The TSF shall implement RADIUS over TLS as specified in RFC 6614 to communicate securely with a RADIUS server.
            </title>
          </f-element>
          <f-element>
            <title>
            The TSF shall perform peer authentication using <selectables>
              <selectable id="s-x509-certs">X.509v3 certificates</selectable>
              <selectable id="s-radsec-psk">pre-shared keys</selectable>
            </selectables>.
            </title>
			  <ext-comp-def-title><title>
              The TSF shall perform peer authentication using <assignable>some authentication method</assignable>.
              </title></ext-comp-def-title>
            <note role="application">
              This SFR is applicable if "RADIUS over TLS" is selected in FTP_ITC.1.1.<h:p/>
              If <xref to="s-x509-certs"/> is selected in FCS_RADSEC_EXT.1.2, then FCS_TLSC_EXT.2 from the NDcPP must be claimed. 
              If <xref to="s-radsec-psk"/> is selected in FCS_RADSEC_EXT.1.2, then FCS_RADSEC_EXT.2 and FIA_PSK_EXT.1 in this PP-Module must be claimed. 
            </note>
            <aactivity>
              <TSS>The evaluator shall verify that the TSS description includes the use of RADIUS over TLS, as described in RFC 6614.<h:p/>
                
                If X.509v3 certificates is selected, the evaluator shall ensure that the TSS description includes the use of client-side certificates for TLS mutual authentication.<h:p/></TSS>
              <Guidance>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the guidance.<h:p/></Guidance>
              <Tests>The evaluator shall demonstrate the ability to successfully establish a RADIUS over TLS connection with a RADIUS server. 
                This test shall be performed with X.509v3 certificates if selected and performed with pre-shared keys if selected.</Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <!-- added by TD0271 -->
        <f-component name="RadSec using Pre-Shared Keys" cc-id="fcs_radsec_ext.2">
		  <depends on="s-radsec-psk"/>
          <consistency-rationale>This SFR defines the implementation of RadSec when pre-shared key authentication is used. This functionality is outside the original scope of the Base-PP but it relies on 
            the TLS client protocol implementation, cryptographic algorithms, and random bit generation functions defined by the Base-PP.</consistency-rationale>
          
          <comp-lev>requires the TSF to implement RadSec using pre-shared key authentication in a manner that conforms to relevant TLS specifications.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_CKM.1 Cryptographic Key Generation<h:p/>
            FCS_COP.1 Cryptographic Operation<h:p/>
            <no-link>FCS_RADSEC_EXT.1</no-link> RadSec<h:p/>
            FCS_RBG_EXT.1 Random Bit Generation<h:p/></dependencies>
          
          <f-element>
            
            <title>The TSF shall implement <selectables>
              <selectable>TLS 1.2 (RFC 5246)</selectable>
              <selectable>TLS 1.1 (RFC 4346)</selectable>
            </selectables> and no earlier TLS versions when acting as a RADIUS over TLS client that supports the following cipher suites: 
              <selectables linebreak="yes">
                <selectable>TLS_PSK_WITH_AES_128_CBC_SHA</selectable>
                <selectable>TLS_PSK_WITH_AES_256_CBC_SHA</selectable>
                <selectable>TLS_DHE_PSK_WITH_AES_128_CBC_SHA</selectable>
                <selectable>TLS_DHE_PSK_WITH_AES_256_CBC_SHA</selectable>
                <selectable id="s-rsa_psk_aes_128_cbc">TLS_RSA_PSK_WITH_AES_128_CBC_SHA</selectable>
                <selectable id="s-rsa_psk_aes_256_cbc">TLS_RSA_PSK_WITH_AES_256_CBC_SHA</selectable>
                <selectable>TLS_PSK_WITH_AES_128_GCM_SHA256</selectable>
                <selectable>TLS_PSK_WITH_AES_256_GCM_SHA384</selectable>
                <selectable>TLS_DHE_PSK_WITH_AES_128_GCM_SHA256</selectable>
                <selectable>TLS_DHE_PSK_WITH_AES_256_GCM_SHA384</selectable>
                <selectable id="s-rsa_psk_aes_128_gcm">TLS_RSA_PSK_WITH_AES_128_GCM_SHA256</selectable>
                <selectable id="s-rsa_psk_aes_256_gcm">TLS_RSA_PSK_WITH_AES_256_GCM_SHA384</selectable>
              </selectables>.
            </title>
            <ext-comp-def-title>
              <title>The TSF shall implement <assignable>list of allowed TLS versions</assignable> and reject all other TLS and SSL versions. 
                The TLS implementation shall support the following cipher suites for use when acting as a RADIUS over TLS client: <assignable>list of supported cipher suites</assignable>.</title>
            </ext-comp-def-title>
            <note role="application">If any of the TLS_RSA_PSK cipher suites are selected by the ST author, it is necessary to claim the selection-based requirement FCS_RADSEC_EXT.3.<h:p/>
              The above cipher suites are only for use when the TSF is acting as a RADIUS over TLS client, not for other uses of the TLS protocol. 
              The cipher suites to be tested in the evaluated configuration are limited by this requirement. 
              The ST author should select the cipher suites that are supported. If "X.509v3 certificates" is selected in FCS_RADSEC_EXT.1.2, 
              the cipher suites selected in (and tested by) FCS_TLSC_EXT.2.1 are also supported for RADIUS over TLS client use.
            </note>
          </f-element>
          <f-element>
            <title>The TSF shall be able to <selectables>
              <selectable>accept</selectable>
              <selectable>generate using the random bit generator specified in FCS_RBG_EXT.1</selectable>
            </selectables> bit-based pre-shared keys.</title>
            <aactivity>
              <TSS>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that the cipher suites supported are specified. 
                The evaluator shall check the TSS to ensure that the cipher suites specified are identical to those listed for this component. 
                The evaluator shall also verify that the TSS contains a description of the denial of old SSL and TLS versions.<h:p/>
                
                The evaluator shall examine the TSS to ensure it describes the process by which the bit-based pre-shared keys are generated (if the TOE supports this functionality), 
                and confirm that this process uses the RBG specified in FCS_RBG_EXT.1.<h:p/></TSS>
              <Guidance>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the guidance.<h:p/>
                
                The evaluator shall also check the guidance documentation to ensure that it contains instructions on configuring the TOE so that RADIUS over TLS conforms to the description in the TSS 
                (for instance, the set of cipher suites advertised by the TOE may have to be restricted to meet the requirements).<h:p/>
                
                The evaluator shall confirm the operational guidance contains instructions for either entering bit-based pre-shared keys, or generating a bit-based pre-shared key (or both).<h:p/></Guidance>
              <Tests>The evaluator shall perform the following tests:
              <testlist>
                <test>The evaluator shall establish a RADIUS over TLS connection using each of the cipher suites selected in FCS_RADSEC_EXT.2.1. 
                  It is sufficient to observe the successful negotiation of a cipher suite to satisfy the intent of the test; it is not necessary 
                  to examine the characteristics of the encrypted traffic in an attempt to discern the cipher suite being used (for example, 
                  that the cryptographic algorithm is 128-bit AES and not 256-bit AES).</test>
                <test>The evaluator shall set the pre-shared key to a value that does not match the server's pre-shared key and demonstrate that the TOE cannot successfully complete a protocol negotiation using this key.</test>
                <test>The evaluator shall configure the server to select the TLS_NULL_WITH_NULL_NULL cipher suite and verify that the client denies the connection.</test>
                <test>The evaluator shall perform the following modifications to the traffic:<h:ul>
                  <h:li>Change the TLS version selected by the server in the Server Hello to a non-supported TLS version (for example 1.3 represented by the two bytes 03 04) and verify that the client rejects the connection.</h:li>
                  <h:li>Modify at least one byte in the server’s nonce in the Server Hello handshake message, and verify that the client rejects the Server Key Exchange handshake message 
                    (if using a DHE cipher suite) or that the server denies the client’s Finished handshake message.</h:li>
                  <h:li>Modify the server’s selected cipher suite in the Server Hello handshake message to be a cipher suite not presented in the Client Hello handshake message. 
                    The evaluator shall verify that the client rejects the connection after receiving the Server Hello.</h:li>
                  <h:li>Modify a byte in the Server Finished handshake message, and verify that the client rejects the connection and does not send any application data.</h:li>
                  <h:li>Send a garbled message from the server after the server has issued the ChangeCipherSpec message and verify that the client denies the connection.</h:li>
                </h:ul></test>
                <test>[conditional] If the TOE does not generate bit-based pre-shared keys, the evaluator shall obtain a bit-based pre-shared key of the appropriate length and enter it according to the instructions in the operational guidance. 
                  The evaluator shall then demonstrate that a successful protocol negotiation can be performed with the key.</test>
                <test>[conditional] If the TOE does generate bit-based pre-shared keys, the evaluator shall generate a bit-based pre-shared key of the appropriate length and use it according to the instructions in the operational guidance. 
                  The evaluator shall then demonstrate that a successful protocol negotiation can be performed with the key.</test>
              </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        <f-component name="RadSec using Pre-Shared Keys and RSA" cc-id="fcs_radsec_ext.3">
		  <depends on="s-rsa_psk_aes_128_cbc" on1="s-rsa_psk_aes_256_cbc" on2="s-rsa_psk_aes_128_gcm" on3="s-rsa_psk_aes_256_gcm"/>
          <consistency-rationale>This SFR defines the implementation of RadSec when pre-shared key authentication with RSA is used. This functionality is outside the original scope of the Base-PP but it relies on 
            the TLS client protocol implementation, cryptographic algorithms, and random bit generation functions defined by the Base-PP.</consistency-rationale>
          
          <comp-lev>requires the TSF to validate the external entity used for trusted communications.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_RADSEC_EXT.2 RadSec using Pre-Shared Keys<h:p/>
            <no-link>FIA_X509_EXT.1</no-link> X.509 Certificate Validation
            <h:p/></dependencies>
          
          <f-element>
            <title>
              When the TSF negotiates a TLS_RSA_PSK cipher suite, the TSF shall verify that the presented identifier matches the reference identifier per RFC 6125 section 6.
            </title>
            <note role="application">This requirement must be claimed if any cipher suites beginning with 'TLS_RSA_PSK' are selected in FCS_RADSEC_EXT.2.1.<h:p/>
              The rules for verification of identity are described in Section 6 of RFC 6125. 
              The reference identifier is typically established by configuration (e.g. configuring the name of the authentication server). 
              Based on a singular reference identifier’s source domain and application service type (e.g. HTTP, SIP, LDAP), 
              the client establishes all reference identifiers which are acceptable, such as a Common Name for the Subject Name field of the certificate and a (case-insensitive) DNS name for the Subject Alternative Name field. 
              The client then compares this list of all acceptable reference identifiers to the presented identifiers in the TLS server’s certificate.<h:p/>
              
              The preferred method for verification is the Subject Alternative Name using DNS names, URI names, or Service Names. 
              Verification using the Common Name is required for the purposes of backwards compatibility. 
              Additionally, support for use of IP addresses in the Subject Name or Subject Alternative name is discouraged as against best practices but may be implemented. 
              Finally, support for wildcards is discouraged but may be implemented. 
              If the client supports wildcards, the client must follow the best practices regarding matching; these best practices are captured in the evaluation activity.<h:p/>
            </note>
          </f-element>
          <f-element>
            <title>When the TSF negotiates a TLS_RSA_PSK cipher suite, the TSF shall  <selectables>
                <selectable>not establish the connection</selectable>
                <selectable>request authorization to establish the connection</selectable>
                <selectable><assignable>other action</assignable></selectable>
              </selectables> if the presented server certificate is deemed invalid.</title>
            <note role="application">This requirement must be claimed if any cipher suites beginning with 'TLS_RSA_PSK' are selected in FCS_RADSEC_EXT.2.1.<h:p/>
              
              Validity is determined by the identifier verification, certificate path, the expiration date, and the revocation status in accordance with RFC 5280. 
              Certificate validity is tested in accordance with testing performed for FIA_X509_EXT.1/Rev in the NDcPP.</note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS describes the client’s method of establishing all reference identifiers from the administrator/application-configured reference identifier, 
                including which types of reference identifiers are supported (e.g., Common Name, DNS Name, URI Name, Service Name, or other application-specific Subject Alternative Names) and whether IP addresses and wildcards are supported. 
                The evaluator shall ensure that this description identifies whether and the manner in which certificate pinning is supported or used by the TOE.<h:p/></TSS>
              <Guidance>
                The evaluator shall verify that the operational guidance includes instructions for setting the reference identifier to be used for the purposes of certificate validation in TLS.<h:p/>    </Guidance>
              <Tests>The evaluator shall perform the following tests:
                <testlist>
                    <test>The evaluator shall attempt to establish the connection using a server with a server certificate that contains the Server Authentication purpose in the extendedKeyUsage field and 
                      verify that a connection is established. The evaluator will then verify that the client rejects an otherwise valid server certificate that lacks the Server Authentication purpose in the extendedKeyUsage 
                      field and a connection is not established. Ideally, the two certificates should be identical except for the extendedKeyUsage field.</test>
                    <test>The evaluator shall present a server certificate that does not contain an identifier in either the Subject Alternative Name (SAN) or Common Name (CN) that matches the reference identifier. 
                      The evaluator shall verify that the connection fails.</test>
                    <test>The evaluator shall present a server certificate that contains a CN that matches the reference identifier, 
                      contains the SAN extension, but does not contain an identifier in the SAN that matches the reference identifier. 
                      The evaluator shall verify that the connection fails. The evaluator shall repeat this test for each supported SAN type.</test>
                    <test>The evaluator shall present a server certificate that contains a CN that does not match the reference identifier but does contain an identifier in the SAN that matches. 
                      The evaluator shall verify that the connection succeeds.</test>
                  <test>[conditional] If the TOE does not mandate the presence of the SAN extension, the evaluator shall present a server certificate that contains a CN that matches the reference identifier and does not contain the SAN extension. 
                      The evaluator shall verify that the connection succeeds. If the TOE does mandate the presence of the SAN extension, this Test shall be omitted.</test>
                  <test>[conditional] If wildcards are supported by the TOE, the evaluator shall perform the following tests: <h:ul>
                      <h:li>The evaluator shall present a server certificate containing a wildcard that is not in the left-most label of the presented identifier (e.g. foo.*.example.com) and verify that the connection fails.</h:li>
                      <h:li>The evaluator shall present a server certificate containing a wildcard in the left-most label but not preceding the public suffix (e.g. *.example.com). 
                        The evaluator shall configure the reference identifier with a single left-most label (e.g. foo.example.com). 
                        The evaluator shall verify that the connection succeeds. The evaluator shall configure the reference identifier without a left-most label as in the certificate (e.g. example.com) and verify that the connection fails. 
                        The evaluator shall configure the reference identifier with two left-most labels (e.g. bar.foo.example.com) and verify that the connection fails.</h:li>
                      <h:li>The evaluator shall present a server certificate containing a wildcard in the left-most label immediately preceding the public suffix (e.g. *.com). 
                        The evaluator shall configure the reference identifier with a single left-most label (e.g. foo.com) and verify that the connection fails. 
                        The evaluator shall configure the reference identifier with two left-most labels (e.g. bar.foo.com) and verify that the connection fails.</h:li>
                    </h:ul>
                    </test>
                    <test>[conditional] If wildcards are not supported by the TOE, the evaluator shall present a server certificate containing a wildcard and verify that the connection fails.</test>
                    <test>[conditional] If URI or Service name reference identifiers are supported, the evaluator shall configure the DNS name and the service identifier. 
                      The evaluator shall present a server certificate containing the correct DNS name and service identifier in the URIName or SRVName fields of the SAN and verify that the connection succeeds. 
                      The evaluator shall repeat this test with the wrong service identifier (but correct DNS name) and verify that the connection fails.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
      </sec:sel_fcs> 
      
      <sec:sel_fia title="Identification and Authentication (FIA)">
        
        <ext-comp-def title="Pre-Shared Key Composition" fam-id="FIA_PSK_EXT">
          <fam-behavior>Components in this family describe requirements for the creation and composition of pre-shared keys used to establish trusted communications channels.</fam-behavior> 
        </ext-comp-def> 
        
        <!-- moved from mandatory by TD0277 -->
        <f-component name="Pre-Shared Key Composition" cc-id="fia_psk_ext.1">
		  <depends on="s-radsec-psk"/>
          <consistency-rationale>This SFR defines parameters for pre-shared key generation. The Base-PP supports pre-shared keys as a potential authentication method for IPsec. This PP-Module 
            does not prevent this from being used but does define restrictions on how pre-shared keys may be generated and what constitutes an acceptable key. 
            This may also be used for RadSec, which is outside the original scope of the Base-PP.</consistency-rationale>
          
          <comp-lev>requires the TSF to support pre-shared keys that meet various characteristics for specific communications usage.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_RBG_EXT.1 Random Bit Generation</dependencies>
          
          <f-element>
            <title>The TSF shall be able to use pre-shared keys for <selectables>
              <selectable>RADIUS over TLS (RadSec)</selectable>
              <selectable>IPsec</selectable>
			  <selectable>WPA3-SAE</selectable>
              <selectable>IEEE 802.11 WPA2-PSK</selectable>
              <selectable><assignable>other protocols that use pre-shared keys</assignable></selectable>
            </selectables>. 
            </title>
          </f-element>
          <f-element>
            <title>The TSF shall be able to accept text-based pre-shared keys that: <h:ul>
              <h:li>are 22 characters and <selectables>
                <selectable><assignable>other supported lengths</assignable></selectable>
                <selectable>no other lengths</selectable>
              </selectables>;</h:li>
              <h:li>are composed of any combination of upper and lower case letters, numbers, and special
                characters (that include: “!”, “@”, “#”, “$”, “%”, “^”, “&amp;”, “*”, “(“, and “)”).
              </h:li>
            </h:ul>
            </title>
          </f-element>
          <f-element>
            <title>The TSF shall be able to <selectables> 
              <selectable>accept</selectable>
              <selectable>generate using the random bit generator specified in FCS_RBG_EXT.1</selectable>
            </selectables> bit-based pre-shared keys.
            </title>
          
          <note role="application">
          This requirement must be included if IPsec or another protocol that uses pre-shared keys is claimed, and pre-shared key authentication is selected 
          (e.g., "Pre-shared Keys" is selected in FCS_IPSEC_EXT.1.13 or "pre-shared keys" is selected in FCS_RADSEC_EXT.1.2). 
          The intent of this requirement is that all protocols will support both text-based and bit-based pre-shared keys.<h:p/>
          
          For the length of the text-based pre-shared keys, a common length (22 characters) is required to help
          promote interoperability. If other lengths are supported they should be listed in the assignment; this
          assignment can also specify a range of values (e.g., "lengths from 5 to 55 characters") as well.<h:p/>
            
          For FIA_PSK_EXT.1.3, the ST author specifies whether the TSF merely accepts bit-based pre-shared keys,
          or is capable of generating them. If it generates them, the requirement specifies that they must be
          generated using the RBG provided by the TOE.
          </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to ensure that it identifies all protocols that allow both text-based
                and bit-based pre-shared keys, and states that text-based pre-shared keys of 22 characters are
                supported. For each protocol identified by the requirement, the evaluator shall confirm that the TSS
                states the conditioning that takes place to transform the text-based pre-shared key from the key
                sequence entered by the user (e.g., ASCII representation) to the bit string used by the protocol, and that
                this conditioning is consistent with the last selection in the FIA_PSK_EXT.1.3 requirement.<h:p/>
                
                The evaluator shall also examine the TSS to ensure it describes the process by which the bit-based
				pre-shared keys are generated (if the TOE supports this functionality), and confirm that this process uses the
                RBG specified in FCS_RBG_EXT.1.<h:p/>
              </TSS>
              <Guidance>The evaluator shall examine the operational guidance to determine that it provides guidance to
                administrators on the composition of strong text-based pre-shared keys, and (if the selection indicates
                keys of various lengths can be entered) that it provides information on the range of lengths supported.
                The guidance must specify the allowable characters for pre-shared keys, and that list must be a superset of the list contained in FIA_PSK_EXT.1.2.<h:p/>
                
                The evaluator shall confirm the operational guidance contains instructions for either entering bit-based
                pre-shared keys for each protocol identified in the requirement, or generating a bit-based pre-shared
                key (or both).<h:p/></Guidance>
              <Tests>The evaluator shall also perform the following tests for each protocol (or instantiation of a protocol, if
                performed by a different implementation on the TOE). Note that one or more of these tests can be
                performed with a single test case.
                <testlist>
                  <test>The evaluator shall compose a pre-shared key of 22 characters that contains a combination of
                    the allowed characters in accordance with the operational guidance, and demonstrates that a successful
                    protocol negotiation can be performed with the key.
                  </test>
                  <test>[conditional]: If the TOE supports pre-shared keys of multiple lengths, the evaluator shall repeat
                    Test 1 using the minimum length; the maximum length; a length inside the allowable range; and invalid
                    lengths beyond the supported range (both higher and lower). The minimum, maximum, and included
                    length tests should be successful, and the invalid lengths must be rejected by the TOE.
                  </test>
                  <test>[conditional]: If the TOE does not generate bit-based pre-shared keys, the evaluator shall obtain a
                    bit-based pre-shared key of the appropriate length and enter it according to the instructions in the
                    operational guidance. The evaluator shall then demonstrate that a successful protocol negotiation can
                    be performed with the key.</test>
                  <test>[conditional]: If the TOE does generate bit-based pre-shared keys, the evaluator shall generate a
                    bit-based pre-shared key of the appropriate length and use it according to the instructions in the
                    operational guidance. The evaluator shall then demonstrate that a successful protocol negotiation can
                    be performed with the key.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:sel_fia> 

    </sel-sfrs>
    <obj-sfrs>
    </obj-sfrs>
    <impl-dep-sfrs></impl-dep-sfrs>
  </sec:Security_Requirements>
  
  <appendix title="Implicitly Satisfied Requirements" id="satisfiedreqs">
    This PP-Module has no implicitly satisfied requirements. All SFR dependencies are explicitly met either through SFRs defined by the PP-Module or inherited from the Base-PP. 
  </appendix>
  
  <appendix title="Allocation of Requirements in Distributed TOEs" id="allocation">
    
    For a distributed TOE, the security functional requirements in this PP-Module need to be met by the
    TOE as a whole, but not all SFRs will necessarily be implemented by all components. The
    following categories are defined in order to specify when each SFR must be implemented by a
    component: <h:ul>
      <h:li><h:b>All Components ("All")</h:b> - All components that comprise the distributed TOE must
        independently satisfy the requirement.</h:li>
      <h:li><h:b>At least one Component ("One")</h:b> - This requirement must be fulfilled by at least one
        component within the distributed TOE.</h:li>
      <h:li><h:b>Feature Dependent ("Feature Dependent")</h:b> - These requirements will only be
        fulfilled where the feature is implemented by the distributed TOE component (note
        that the requirement to meet the PP-Module as a whole requires that at least one component
        implements these requirements if they are claimed by the TOE).</h:li></h:ul>
    The table below specifies how each of the SFRs in this PP-Module must be met, using the categories above.
    
    <h:table>
      <h:tr class="header">
        <h:td>Requirement</h:td>
        <h:td>Description</h:td>
        <h:td>Distributed TOE SFR Allocation</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_CKM.1/WPA</h:td>
        <h:td>Cryptographic Key Generation (Symmetric Keys for WPA2 Connections)</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_CKM.2/GTK</h:td>
        <h:td>Cryptographic Key Distribution (GTK)</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_CKM.2/PMK</h:td>
        <h:td>Cryptographic Key Distribution (PMK)</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_8021X_EXT.1</h:td>
        <h:td>802.1X Port Access Entity (Authenticator) Authentication</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_UAU.6</h:td>
        <h:td>Re-Authenticating</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FMT_SMR_EXT.1</h:td>
        <h:td>No Administration from Client</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FPT_FLS.1</h:td>
        <h:td>Failure with Preservation of Secure State</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FTA_TSE.1</h:td>
        <h:td>TOE Session Establishment</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_CKM.2/DISTRIB</h:td>
        <h:td>Cryptographic Key Distribution (802.11 Keys)</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_RADSEC_EXT.1</h:td>
        <h:td>RadSec</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_RADSEC_EXT.1</h:td>
        <h:td>RadSec using Pre-Shared Keys</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_PSK_EXT.1</h:td>
        <h:td>Pre-Shared Key Composition</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
    </h:table>
    
  </appendix>
  
  <appendix title="Entropy Documentation and Assessment" id="EAR">
    The TOE does not require any additional supplementary information to describe its entropy sources beyond the requirements outlined in the Base-PP.  
  </appendix>
  
  <bibliography>
    <cc-entry/>
    
    
    <entry id="bibNDcPP">
      <tag>NDcPP</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/MMO/PP/CPP_ND_V2.2E.pdf">collaborative Protection Profile for Network Devices</h:a>, Version 2.2e, March 23, 2020
      </description>
    </entry>
    
    <entry id="bibNDSD">
      <tag>NDcPP SD</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/MMO/PP/CPP_ND_V2.2-SD.pdf">Supporting Document - Evaluation Activities for Network Device cPP</h:a>, Version 2.2, December 2019
      </description>
    </entry>

  </bibliography>
</Module>
